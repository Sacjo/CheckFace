<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CheckFace Web – Registro de Asistencia</title>
  <link 
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" 
    rel="stylesheet"
  >
</head>
<body class="bg-light">

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-bold" href="{{ url_for('main.index') }}">CheckFace</a>
      <span id="currentDateTime" class="ms-3 text-muted"></span>
      <a href="{{ url_for('main.logout') }}" class="btn btn-outline-secondary ms-auto">Cerrar sesión</a>
    </div>
  </nav>

  <div class="container my-5">
    <h1 class="mb-4">Registro de Asistencia</h1>
    <div class="row gy-4">

      <!-- IZQUIERDA: cámara + no reconocidos -->
      <div class="col-lg-6">
        <!-- Cámara -->
        <div class="card shadow-sm">
          <div class="card-header bg-primary text-white">Cámara en vivo</div>
          <div class="card-body text-center">
            <video 
              id="video"
              class="img-fluid mb-3 rounded"
              autoplay muted playsinline
              style="max-height:300px; background:#000"
            ></video>
            <canvas id="snapshot" width="640" height="480" style="display:none"></canvas>
            
            <!-- Botones de control -->
            <button id="startBtn" class="btn btn-primary">
              Iniciar reconocimiento (1 min)
            </button>
            <button id="stopBtn" class="btn btn-danger ms-2" disabled>
              Detener reconocimiento
            </button>
            <span id="timer" class="ms-3 fw-bold"></span>
          </div>
        </div>

        <!-- No reconocidos -->
        <div class="card shadow-sm mt-4">
          <div class="card-header bg-danger text-white">No reconocidos</div>
          <div class="card-body p-0">
            <ul id="unrecognizedList" class="list-group list-group-flush">
              <!-- elementos añadidos dinámicamente -->
            </ul>
          </div>
        </div>
      </div>

      <!-- DERECHA: tabla de reconocidos -->
      <div class="col-lg-6">
        <div class="card shadow-sm">
          <div class="card-header bg-success text-white">Asistencia</div>
          <div class="card-body p-0">
            <table class="table table-striped mb-0">
              <thead class="table-light">
                <tr><th>Alumno</th><th>Hora</th><th>Estado</th></tr>
              </thead>
              <tbody id="attendanceTable"></tbody>
            </table>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script 
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    defer
  ></script>
  <script 
    src="{{ url_for('static', filename='js/main.js') }}"
    defer
  ></script>
</body>
</html>
